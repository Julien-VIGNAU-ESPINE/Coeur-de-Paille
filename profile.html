<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Tableau de Bord - C≈ìur de Paille</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,400;0,700;1,400&family=Inter:wght@400;500;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <!-- Updated Navigation (Top) -->
    <nav class="nav-bar">
        <div class="nav-logo">C≈ìur de Paille</div>
        <div class="nav-links">
            <a href="discovery.html" class="nav-item">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
                <span class="nav-label">D√©couverte</span>
            </a>
            <a href="messages.html" class="nav-item">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path
                        d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z">
                    </path>
                </svg>
                <span class="nav-label">Messages</span>
            </a>
            <a href="profile.html" class="nav-item active">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
                <span class="nav-label">Profil</span>
            </a>
        </div>
    </nav>

    <div class="container animate-fade-in">

        <!-- Header Image & Avatar -->
        <div class="profile-cover" id="coverImage"
            style="background-image: url('https://images.unsplash.com/photo-1595960009667-fe6240292728?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');">
            <div class="profile-avatar-large" id="myAvatar"></div>
            <div class="profile-actions">
                <button id="btnOpenEdit" class="btn btn-primary btn-small">Modifier</button>
                <button id="btnOpenSettings" class="btn btn-outline btn-small"
                    style="background:white; border:none; box-shadow: var(--shadow-card);">‚öôÔ∏è</button>
            </div>
        </div>

        <div style="margin-left: 190px; margin-bottom: 40px; min-height: 80px;">
            <h1 id="myName" style="margin-bottom: 5px;">Chargement...</h1>
            <p id="myBio" style="color: #666; max-width: 600px;">...</p>
        </div>

        <div class="dashboard-grid">

            <!-- Left Column: Stats & Photos -->
            <div class="main-column">

                <!-- Stats -->
                <div class="dashboard-card" style="margin-bottom: 24px;">
                    <h3>üìä Statistiques</h3>
                    <div class="stats-row">
                        <div class="stat-item">
                            <h4 id="statViews">124</h4>
                            <span>Vues</span>
                        </div>
                        <div class="stat-item">
                            <h4 id="statLikes">18</h4>
                            <span>Likes</span>
                        </div>
                        <div class="stat-item">
                            <h4 id="statMatches">4</h4>
                            <span>Matchs</span>
                        </div>
                    </div>
                </div>

                <!-- Gallery -->
                <div class="dashboard-card">
                    <h3>üì∑ Ma Galerie</h3>
                    <div class="gallery-grid" id="galleryGrid">
                        <!-- Injected JS -->
                        <div class="gallery-item add-photo">+</div>
                        <div class="gallery-item"
                            style="background-image: url('https://images.unsplash.com/photo-1500382017468-9049fed747ef?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80')">
                        </div>
                        <div class="gallery-item"
                            style="background-image: url('https://images.unsplash.com/photo-1444858291040-58f756a3bdd6?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80')">
                        </div>
                        <div class="gallery-item"
                            style="background-image: url('https://images.unsplash.com/photo-1500937386664-56d1dfef3854?ixlib=rb-1.2.1&auto=format&fit=crop&w=300&q=80')">
                        </div>
                    </div>
                </div>

            </div>

            <!-- Right Column: Details & Settings -->
            <div class="side-column">
                <!-- Info -->
                <div class="dashboard-card" style="margin-bottom: 24px;">
                    <h3>‚ÑπÔ∏è Informations</h3>
                    <div class="info-list">
                        <p><span class="info-icon">üìç</span> <span id="infoLoc">Localisation inconnue</span></p>
                        <p><span class="info-icon">ÔøΩ</span> <span id="infoRole">Agriculteur</span></p>
                        <p><span class="info-icon">üéÇ</span> <span id="infoAge">29 ans</span></p>
                        <p><span class="info-icon">üìß</span> <span id="infoEmail">email@exemple.com</span></p>
                    </div>
                </div>

                <!-- Actions -->
            </div>

        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div id="editProfileModal" class="modal-overlay" style="display: none;">
        <div class="modal-content animate-fade-in">
            <header class="modal-header">
                <h2>Modifier le Profil</h2>
                <span class="close-modal" id="closeEditProfile">&times;</span>
            </header>
            <div class="filter-group">
                <label>Photo de Profil</label>
                <div class="avatar-upload-container">
                    <div class="avatar-preview" id="previewAvatar"></div>
                    <label for="editAvatarFile" class="btn-upload">Changer la photo</label>
                    <input type="file" id="editAvatarFile" accept="image/*" style="display: none;">
                </div>
            </div>

            <div class="filter-group">
                <label>Nom</label>
                <input type="text" id="editName" value="Julien Vignau">
            </div>
            <div class="filter-group">
                <label>Date de Naissance</label>
                <input type="date" id="editDob">
            </div>

            <!-- ... existing fields ... -->

            <div class="filter-group">
                <label>Bio</label>
                <textarea id="editBio" rows="4"
                    style="width: 100%; padding: 14px; border: 2px solid #eee; border-radius: 12px; font-family: inherit; resize: none;">Passionn√© par l'agro-√©cologie...</textarea>
            </div>

            <div class="filter-group">
                <label>Banni√®re de Profil</label>
                <div class="banner-grid" id="bannerSelector">
                    <!-- Presets will be injected or hardcoded here -->
                    <div class="banner-option"
                        data-url="https://images.unsplash.com/photo-1595960009667-fe6240292728?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80">
                        <img src="https://images.unsplash.com/photo-1595960009667-fe6240292728?ixlib=rb-1.2.1&auto=format&fit=crop&w=150&q=80"
                            alt="Champ">
                    </div>
                    <div class="banner-option"
                        data-url="https://images.unsplash.com/photo-1500382017468-9049fed747ef?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80">
                        <img src="https://images.unsplash.com/photo-1500382017468-9049fed747ef?ixlib=rb-1.2.1&auto=format&fit=crop&w=150&q=80"
                            alt="Montagne">
                    </div>
                    <div class="banner-option"
                        data-url="https://images.unsplash.com/photo-1492496913980-501348b61469?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80">
                        <img src="https://images.unsplash.com/photo-1492496913980-501348b61469?ixlib=rb-1.2.1&auto=format&fit=crop&w=150&q=80"
                            alt="Tracteur">
                    </div>
                    <div class="banner-option"
                        data-url="https://images.unsplash.com/photo-1444858291040-58f756a3bdd6?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80">
                        <img src="https://images.unsplash.com/photo-1444858291040-58f756a3bdd6?ixlib=rb-1.2.1&auto=format&fit=crop&w=150&q=80"
                            alt="For√™t">
                    </div>
                </div>
            </div>

            <div class="filter-group">
                <label>Localisation</label>
                <input type="text" id="editLoc" value="Auch, Gers">
            </div>
            <div class="filter-group">
                <label>Activit√©</label>
                <input type="text" id="editActivity" value="√âleveur Ovin">
            </div>
            <button class="btn btn-primary" id="saveProfile" style="width:100%">Enregistrer</button>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal-overlay" style="display: none;">
        <div class="modal-content animate-fade-in">
            <header class="modal-header">
                <h2>Param√®tres</h2>
                <span class="close-modal" id="closeSettings">&times;</span>
            </header>

            <div class="settings-group">
                <div class="setting-item">
                    <div class="setting-text">
                        <h4>Notifications</h4>
                        <p>√ätre averti des nouveaux messages</p>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="toggleNotifs" checked>
                        <span class="slider round"></span>
                    </label>
                </div>

                <div class="setting-item">
                    <div class="setting-text">
                        <h4>Mode Priv√©</h4>
                        <p>Cacher mon profil de la d√©couverte</p>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="togglePrivate">
                        <span class="slider round"></span>
                    </label>
                </div>

                <div class="setting-item">
                    <div class="setting-text">
                        <h4>Sons</h4>
                        <p>Effets sonores de l'application</p>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="toggleSounds">
                        <span class="slider round"></span>
                    </label>
                </div>
            </div>

            <button class="btn btn-outline" onclick="handleLogout()"
                style="width:100%; margin-top:20px; color: #c0392b; border-color: #c0392b;">
                D√©connexion
            </button>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>

    <script src="js/services/firebase-config.js"></script>
    <script src="js/services/mock-data.js"></script>
    <script src="js/services/api.js"></script>
    <script src="js/profile.js"></script>
</body>

</html>